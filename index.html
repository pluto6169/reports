<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>ğŸ§© Business Canvas Studio</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=JetBrains+Mono:wght@400;500;600&family=Noto+Naskh+Arabic:wght@400;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
:root {
  --bg: #0a0a14;
  --bg2: #0f0f1a;
  --card: #13131f;
  --card2: #1a1a2e;
  --card3: #16213e;
  --note: #1e1e32;
  --border: #2a2a4a;
  --border2: #1e1e38;
  --accent: #e94560;
  --accent2: #0f3460;
  --text: #eaeaea;
  --subtext: #7a7a9a;
  --success: #4ecca3;
  --gold: #ffd700;
  --note-text: #f0ead8;

  --c-bmc:  #e94560;
  --c-lean: #4ecca3;
  --c-mkt:  #ffd700;
  --c-vpc:  #a855f7;
  --c-swot: #38bdf8;
  --c-aarrr:#fb923c;

  --font-display: 'Playfair Display', serif;
  --font-mono: 'JetBrains Mono', monospace;
  --font-ar: 'Noto Naskh Arabic', serif;

  --sidebar-w: 240px;
  --radius: 8px;
  --transition: 0.2s cubic-bezier(0.4,0,0.2,1);
  
  /* Mobile bottom nav height */
  --bottom-nav-h: 60px;
  --topbar-h: 56px;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { height: 100%; -webkit-tap-highlight-color: transparent; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: var(--font-mono);
  height: 100vh;
  height: 100dvh;
  display: flex;
  overflow: hidden;
}

::-webkit-scrollbar { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: var(--bg2); }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SIDEBAR â€” Desktop only
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#sidebar {
  width: var(--sidebar-w);
  min-width: var(--sidebar-w);
  background: var(--card3);
  border-right: 1px solid var(--border2);
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  overflow-x: hidden;
  z-index: 100;
  transition: transform 0.3s ease;
}

.sidebar-logo {
  padding: 28px 20px 16px;
  text-align: center;
  border-bottom: 1px solid var(--border2);
}
.sidebar-logo .icon { font-size: 36px; display: block; margin-bottom: 4px; }
.sidebar-logo .title { font-family: var(--font-display); font-size: 16px; color: var(--text); letter-spacing: 0.5px; }
.sidebar-logo .subtitle { font-size: 11px; color: var(--subtext); font-family: var(--font-ar); margin-top: 2px; }

.nav-section { padding: 12px 0; flex: 1; }

.nav-btn {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 20px;
  cursor: pointer;
  transition: all var(--transition);
  border: none;
  background: none;
  color: var(--subtext);
  font-family: var(--font-mono);
  font-size: 12px;
  width: 100%;
  text-align: left;
  border-left: 3px solid transparent;
}
.nav-btn:hover { background: rgba(255,255,255,0.04); color: var(--text); }
.nav-btn.active { color: var(--text); background: rgba(255,255,255,0.05); }
.nav-btn .nav-icon { font-size: 16px; width: 20px; text-align: center; flex-shrink: 0; }
.nav-btn .nav-label { flex: 1; }

.nav-divider { height: 1px; background: var(--border2); margin: 8px 16px; }

.sidebar-actions { padding: 12px; display: flex; flex-direction: column; gap: 6px; }

.sb-btn {
  padding: 8px 12px;
  background: var(--accent2);
  color: var(--text);
  border: none;
  border-radius: var(--radius);
  cursor: pointer;
  font-family: var(--font-mono);
  font-size: 11px;
  transition: all var(--transition);
  text-align: left;
}
.sb-btn:hover { background: var(--accent); transform: translateX(2px); }
.sb-btn.danger { background: rgba(233,69,96,0.15); color: var(--accent); border: 1px solid rgba(233,69,96,0.3); }
.sb-btn.danger:hover { background: var(--accent); color: white; }

.sidebar-clock {
  padding: 12px 20px;
  font-size: 11px;
  color: var(--subtext);
  text-align: center;
  border-top: 1px solid var(--border2);
  white-space: pre-line;
  line-height: 1.6;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOBILE OVERLAY SIDEBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#sidebar-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  z-index: 200;
  backdrop-filter: blur(2px);
}
#sidebar-overlay.show { display: block; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN CONTENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#main {
  flex: 1;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  min-width: 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOBILE TOP BAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#mobile-topbar {
  display: none;
  height: var(--topbar-h);
  background: var(--card);
  border-bottom: 1px solid var(--border2);
  align-items: center;
  padding: 0 16px;
  gap: 12px;
  flex-shrink: 0;
  z-index: 50;
}
.mobile-menu-btn {
  background: none;
  border: none;
  color: var(--subtext);
  font-size: 22px;
  cursor: pointer;
  padding: 4px;
  line-height: 1;
  flex-shrink: 0;
}
.mobile-topbar-title {
  font-family: var(--font-display);
  font-size: 15px;
  color: var(--text);
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.mobile-topbar-actions {
  display: flex;
  gap: 6px;
  flex-shrink: 0;
}
.mobile-icon-btn {
  background: rgba(255,255,255,0.07);
  border: none;
  color: var(--text);
  font-size: 16px;
  cursor: pointer;
  padding: 7px 10px;
  border-radius: 6px;
  line-height: 1;
  transition: background var(--transition);
}
.mobile-icon-btn:active { background: rgba(255,255,255,0.15); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOBILE BOTTOM NAV
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#mobile-bottom-nav {
  display: none;
  height: var(--bottom-nav-h);
  background: var(--card);
  border-top: 1px solid var(--border2);
  flex-shrink: 0;
  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
}
#mobile-bottom-nav::-webkit-scrollbar { display: none; }
.mobile-nav-inner {
  display: flex;
  align-items: stretch;
  height: 100%;
  min-width: max-content;
  padding: 0 4px;
}
.mobile-nav-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 4px 14px;
  cursor: pointer;
  border: none;
  background: none;
  color: var(--subtext);
  font-family: var(--font-mono);
  font-size: 9px;
  gap: 3px;
  border-bottom: 2px solid transparent;
  white-space: nowrap;
  transition: all var(--transition);
  min-width: 56px;
}
.mobile-nav-item.active { color: var(--c, var(--accent)); border-bottom-color: var(--c, var(--accent)); }
.mobile-nav-item .mn-icon { font-size: 18px; }
.mobile-nav-divider { width: 1px; background: var(--border2); margin: 10px 0; flex-shrink: 0; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   WELCOME
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#welcome {
  flex: 1;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding: 0;
  display: none;
  flex-direction: column;
}
#welcome.visible { display: flex; }

.welcome-hero {
  background: linear-gradient(135deg, var(--card2) 0%, var(--card3) 100%);
  padding: 48px 32px 36px;
  border-bottom: 1px solid var(--border2);
  position: relative;
  overflow: hidden;
}
.welcome-hero::before {
  content: '';
  position: absolute;
  top: -50%;
  right: -10%;
  width: 300px;
  height: 300px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(233,69,96,0.08) 0%, transparent 70%);
  pointer-events: none;
}
.welcome-hero .eyebrow { font-size: 11px; color: var(--subtext); letter-spacing: 3px; text-transform: uppercase; margin-bottom: 10px; }
.welcome-hero h1 { font-family: var(--font-display); font-size: 42px; color: var(--text); line-height: 1.1; margin-bottom: 10px; }
.welcome-hero h1 span { color: var(--accent); }
.welcome-hero .tagline { font-size: 14px; color: var(--subtext); font-family: var(--font-ar); }

.welcome-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  padding: 28px 32px;
  flex: 1;
}

.welcome-card {
  background: var(--card);
  border: 1px solid var(--border2);
  border-radius: var(--radius);
  padding: 22px 18px;
  cursor: pointer;
  transition: all 0.25s cubic-bezier(0.4,0,0.2,1);
  position: relative;
  overflow: hidden;
  animation: fadeUp 0.4s ease both;
}
.welcome-card:nth-child(1) { animation-delay: 0.05s; }
.welcome-card:nth-child(2) { animation-delay: 0.10s; }
.welcome-card:nth-child(3) { animation-delay: 0.15s; }
.welcome-card:nth-child(4) { animation-delay: 0.20s; }
.welcome-card:nth-child(5) { animation-delay: 0.25s; }
.welcome-card:nth-child(6) { animation-delay: 0.30s; }

.welcome-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 3px;
  background: var(--c);
  transform: scaleX(0);
  transition: transform 0.25s ease;
  transform-origin: left;
}
.welcome-card:hover { transform: translateY(-4px); border-color: var(--c); box-shadow: 0 12px 40px rgba(0,0,0,0.4); }
.welcome-card:hover::before { transform: scaleX(1); }
.welcome-card:active { transform: scale(0.97); }

.welcome-card .card-icon { font-size: 26px; margin-bottom: 10px; display: block; }
.welcome-card .card-title { font-family: var(--font-display); font-size: 15px; color: var(--c); margin-bottom: 5px; }
.welcome-card .card-desc { font-size: 11px; color: var(--subtext); font-family: var(--font-ar); line-height: 1.5; }
.welcome-card .card-author { margin-top: 10px; font-size: 9px; color: var(--border); letter-spacing: 1px; text-transform: uppercase; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CANVAS VIEW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#canvas-view {
  flex: 1;
  overflow: hidden;
  display: none;
  flex-direction: column;
  min-height: 0;
}
#canvas-view.visible { display: flex; }

.canvas-topbar {
  background: var(--card);
  border-bottom: 1px solid var(--border2);
  padding: 0 16px;
  display: flex;
  align-items: center;
  gap: 12px;
  height: var(--topbar-h);
  flex-shrink: 0;
}
.canvas-topbar-title { font-family: var(--font-display); font-size: 16px; color: var(--accent-current); flex: 1; }
.canvas-topbar-sub { font-size: 10px; color: var(--subtext); }

.top-btn {
  padding: 7px 12px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-family: var(--font-mono);
  font-size: 11px;
  font-weight: 600;
  transition: all var(--transition);
  white-space: nowrap;
}
.top-btn.save    { background: var(--accent2); color: var(--text); }
.top-btn.save:hover { background: var(--accent); }
.top-btn.pdf     { background: rgba(78,204,163,0.15); color: var(--success); border: 1px solid rgba(78,204,163,0.3); }
.top-btn.pdf:hover { background: var(--success); color: #0a0a14; }
.top-btn.clear   { background: rgba(233,69,96,0.1); color: var(--accent); border: 1px solid rgba(233,69,96,0.2); }
.top-btn.clear:hover { background: var(--accent); color: white; }
.top-btn.back    { background: rgba(255,255,255,0.06); color: var(--subtext); }
.top-btn.back:hover { background: rgba(255,255,255,0.1); color: var(--text); }
.top-btn:active { transform: scale(0.95); }

.topbar-accent-line { height: 2px; background: var(--accent-current, var(--accent)); flex-shrink: 0; }

.canvas-scroll-area {
  flex: 1;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
  padding: 12px;
  background: var(--bg2);
  min-height: 0;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CANVAS CELLS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.canvas-grid {
  display: grid;
  gap: 8px;
  height: max-content;
}

.canvas-cell {
  background: var(--note);
  border: 1px solid var(--border2);
  border-radius: var(--radius);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  min-height: 160px;
  transition: border-color var(--transition), box-shadow var(--transition);
  animation: fadeUp 0.3s ease both;
}
.canvas-cell:focus-within {
  border-color: var(--accent-current);
  box-shadow: 0 0 0 1px var(--accent-current);
}

.cell-header {
  background: var(--accent2);
  padding: 8px 10px;
  display: flex;
  align-items: flex-start;
  gap: 8px;
  flex-shrink: 0;
}
.cell-header-text { font-size: 11px; font-weight: 600; color: var(--accent-current); line-height: 1.4; font-family: var(--font-mono); }
.cell-hint { font-size: 10px; color: var(--subtext); padding: 5px 10px 4px; font-family: var(--font-ar); line-height: 1.5; flex-shrink: 0; border-bottom: 1px solid var(--border2); }

.cell-textarea {
  flex: 1;
  background: transparent;
  border: none;
  outline: none;
  color: var(--note-text);
  font-family: var(--font-mono);
  font-size: 13px;
  line-height: 1.8;
  padding: 10px 10px;
  resize: none;
  min-height: 90px;
  width: 100%;
  caret-color: var(--accent-current);
  -webkit-appearance: none;
  touch-action: manipulation;
}
.cell-textarea::placeholder { color: var(--border); font-style: italic; }

/* Ruled lines */
.cell-textarea {
  background-image: repeating-linear-gradient(transparent, transparent 28px, rgba(42,42,74,0.4) 28px, rgba(42,42,74,0.4) 29px);
  background-attachment: local;
  background-position: 0 36px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GRID LAYOUTS â€” DESKTOP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.grid-bmc {
  grid-template-columns: repeat(5, 1fr);
  grid-template-rows: repeat(3, 1fr);
  min-height: calc(100vh - 120px);
}
.bmc-partners   { grid-column:1; grid-row:1/3; }
.bmc-activities { grid-column:2; grid-row:1; }
.bmc-value      { grid-column:3; grid-row:1/3; }
.bmc-relations  { grid-column:4; grid-row:1; }
.bmc-segments   { grid-column:5; grid-row:1/3; }
.bmc-resources  { grid-column:2; grid-row:2; }
.bmc-channels   { grid-column:4; grid-row:2; }
.bmc-cost       { grid-column:1/3; grid-row:3; }
.bmc-revenue    { grid-column:3/6; grid-row:3; }

.grid-lean {
  grid-template-columns: repeat(5, 1fr);
  grid-template-rows: repeat(3, 1fr);
  min-height: calc(100vh - 120px);
}
.lean-problem   { grid-column:1; grid-row:1/3; }
.lean-solution  { grid-column:2; grid-row:1; }
.lean-uvp       { grid-column:3; grid-row:1/3; }
.lean-unfair    { grid-column:4; grid-row:1; }
.lean-segments  { grid-column:5; grid-row:1/3; }
.lean-metrics   { grid-column:2; grid-row:2; }
.lean-channels  { grid-column:4; grid-row:2; }
.lean-cost      { grid-column:1/3; grid-row:3; }
.lean-revenue   { grid-column:3/6; grid-row:3; }

.grid-marketing { grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(3, 1fr); min-height: calc(100vh - 120px); }
.grid-vpc       { grid-template-columns: repeat(2, 1fr); grid-template-rows: repeat(3, 1fr); min-height: calc(100vh - 120px); }
.grid-swot      { grid-template-columns: repeat(2, 1fr); grid-template-rows: repeat(2, 1fr); min-height: calc(100vh - 120px); }
.grid-aarrr     { grid-template-columns: 1fr; grid-template-rows: repeat(5, 1fr); min-height: calc(100vh - 120px); }
.aarrr-cell     { min-height: 120px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NOTIFICATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#toast {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%) translateY(-80px);
  background: var(--success);
  color: #0a0a14;
  padding: 10px 24px;
  border-radius: 40px;
  font-weight: 600;
  font-size: 13px;
  z-index: 9999;
  transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1);
  white-space: nowrap;
  pointer-events: none;
  box-shadow: 0 8px 32px rgba(0,0,0,0.5);
  max-width: 90vw;
  text-align: center;
}
#toast.show { transform: translateX(-50%) translateY(0); }
#toast.error { background: var(--accent); color: white; }

/* PDF overlay */
#pdf-overlay {
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.8);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 8888;
  backdrop-filter: blur(4px);
  padding: 20px;
}
#pdf-overlay.show { display: flex; }
.pdf-modal {
  background: var(--card2);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 32px 36px;
  text-align: center;
  min-width: 260px;
  width: 100%;
  max-width: 340px;
}
.pdf-modal h3 { font-family: var(--font-display); font-size: 20px; color: var(--success); margin-bottom: 10px; }
.pdf-modal p  { color: var(--subtext); font-size: 13px; margin-bottom: 16px; }
.pdf-spinner {
  width: 40px; height: 40px;
  border: 3px solid var(--border);
  border-top-color: var(--success);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin: 0 auto 16px;
}
@keyframes spin { to { transform: rotate(360deg); } }
@keyframes fadeUp { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE â€” TABLET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (max-width: 900px) {
  :root { --sidebar-w: 200px; }
  .welcome-hero h1 { font-size: 34px; }
  .welcome-grid { grid-template-columns: repeat(2, 1fr); padding: 20px 20px; gap: 12px; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE â€” MOBILE  â‰¤ 640px
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (max-width: 640px) {
  /* Hide desktop sidebar */
  #sidebar {
    position: fixed;
    top: 0; left: 0; bottom: 0;
    z-index: 300;
    transform: translateX(-100%);
    width: 80vw;
    max-width: 300px;
    box-shadow: 4px 0 40px rgba(0,0,0,0.8);
  }
  #sidebar.open { transform: translateX(0); }
  #sidebar-overlay { display: none; }
  #sidebar-overlay.show { display: block; }

  /* Show mobile topbar */
  #mobile-topbar { display: flex; }

  /* Hide desktop canvas topbar (replaced by mobile topbar + bottom nav) */
  .canvas-topbar { display: none; }
  .topbar-accent-line { display: none; }

  /* Show mobile bottom nav */
  #mobile-bottom-nav { display: flex; }

  /* Welcome */
  .welcome-hero { padding: 28px 20px 24px; }
  .welcome-hero h1 { font-size: 28px; }
  .welcome-hero .eyebrow { font-size: 10px; }
  .welcome-hero .tagline { font-size: 13px; }
  .welcome-grid { grid-template-columns: 1fr 1fr; padding: 16px; gap: 10px; }
  .welcome-card { padding: 16px 14px; }
  .welcome-card .card-icon { font-size: 22px; margin-bottom: 8px; }
  .welcome-card .card-title { font-size: 13px; }
  .welcome-card .card-desc { font-size: 11px; }
  .welcome-card .card-author { display: none; }

  /* Canvas: switch ALL grids to single-column */
  .canvas-grid {
    grid-template-columns: 1fr !important;
    grid-template-rows: auto !important;
    min-height: unset !important;
  }

  /* Reset ALL grid placements */
  .canvas-cell,
  .bmc-partners, .bmc-activities, .bmc-value, .bmc-relations,
  .bmc-segments, .bmc-resources, .bmc-channels, .bmc-cost, .bmc-revenue,
  .lean-problem, .lean-solution, .lean-uvp, .lean-unfair, .lean-segments,
  .lean-metrics, .lean-channels, .lean-cost, .lean-revenue {
    grid-column: 1 !important;
    grid-row: auto !important;
  }

  .canvas-cell { min-height: 160px; }
  .aarrr-cell  { min-height: 140px; }

  .canvas-scroll-area { padding: 10px; }
  .cell-textarea { font-size: 14px; }
}

/* Very small screens */
@media (max-width: 380px) {
  .welcome-grid { grid-template-columns: 1fr; }
  .welcome-hero h1 { font-size: 24px; }
}
</style>
</head>
<body>

<!-- Sidebar overlay for mobile -->
<div id="sidebar-overlay" onclick="closeSidebar()"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SIDEBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<aside id="sidebar">
  <div class="sidebar-logo">
    <span class="icon">ğŸ§©</span>
    <div class="title">Canvas Studio</div>
    <div class="subtitle">Ù…Ø®Ø·Ø·Ø§Øª Ø§Ù„Ø£Ø¹Ù…Ø§Ù„</div>
  </div>

  <nav class="nav-section">
    <button class="nav-btn active" data-view="welcome" onclick="showWelcome()">
      <span class="nav-icon">ğŸ </span>
      <span class="nav-label">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
    </button>
    <div class="nav-divider"></div>
    <button class="nav-btn" data-canvas="BMC" onclick="showCanvas('BMC')" style="--c:var(--c-bmc)">
      <span class="nav-icon">ğŸ¯</span><span class="nav-label">BMC</span>
    </button>
    <button class="nav-btn" data-canvas="Lean" onclick="showCanvas('Lean')" style="--c:var(--c-lean)">
      <span class="nav-icon">ğŸ§ </span><span class="nav-label">Lean Canvas</span>
    </button>
    <button class="nav-btn" data-canvas="Marketing" onclick="showCanvas('Marketing')" style="--c:var(--c-mkt)">
      <span class="nav-icon">ğŸ“Š</span><span class="nav-label">Marketing</span>
    </button>
    <button class="nav-btn" data-canvas="VPC" onclick="showCanvas('VPC')" style="--c:var(--c-vpc)">
      <span class="nav-icon">ğŸ¯</span><span class="nav-label">Value Prop.</span>
    </button>
    <button class="nav-btn" data-canvas="SWOT" onclick="showCanvas('SWOT')" style="--c:var(--c-swot)">
      <span class="nav-icon">ğŸ“ˆ</span><span class="nav-label">SWOT</span>
    </button>
    <button class="nav-btn" data-canvas="AARRR" onclick="showCanvas('AARRR')" style="--c:var(--c-aarrr)">
      <span class="nav-icon">ğŸš€</span><span class="nav-label">AARRR Funnel</span>
    </button>
  </nav>

  <div class="nav-divider"></div>
  <div class="sidebar-actions">
    <button class="sb-btn" onclick="saveAll()">ğŸ’¾  Ø­ÙØ¸ Ø§Ù„ÙƒÙ„</button>
    <button class="sb-btn danger" onclick="clearAll()">ğŸ—‘ï¸  Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
  </div>
  <div class="sidebar-clock" id="clock">--:--:--</div>
</aside>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<main id="main">

  <!-- MOBILE TOP BAR -->
  <div id="mobile-topbar">
    <button class="mobile-menu-btn" onclick="toggleSidebar()">â˜°</button>
    <div class="mobile-topbar-title" id="mobile-title">ğŸ§© Canvas Studio</div>
    <div class="mobile-topbar-actions">
      <button class="mobile-icon-btn" onclick="saveCurrentCanvas()" title="Ø­ÙØ¸">ğŸ’¾</button>
      <button class="mobile-icon-btn" onclick="exportPDF()" title="PDF">ğŸ“„</button>
      <button class="mobile-icon-btn" onclick="showWelcome()" title="Ø±Ø¬ÙˆØ¹">ğŸ </button>
    </div>
  </div>

  <!-- WELCOME -->
  <div id="welcome" class="visible">
    <div class="welcome-hero">
      <div class="eyebrow">Business Canvas Studio</div>
      <h1>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ<br><span>Canvas Studio</span></h1>
      <div class="tagline">Ø§Ø¨Ø¯Ø£ Ø±Ø³Ù… Ù…Ø³ØªÙ‚Ø¨Ù„ Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø§Ù„Ø¢Ù† ğŸš€</div>
    </div>
    <div class="welcome-grid">
      <div class="welcome-card" style="--c:var(--c-bmc)" onclick="showCanvas('BMC')">
        <span class="card-icon">ğŸ¯</span>
        <div class="card-title">Business Model Canvas</div>
        <div class="card-desc">9 Ø®Ø§Ù†Ø§Øª Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¹Ù…Ù„Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„</div>
        <div class="card-author">Alexander Osterwalder</div>
      </div>
      <div class="welcome-card" style="--c:var(--c-lean)" onclick="showCanvas('Lean')">
        <span class="card-icon">ğŸ§ </span>
        <div class="card-title">Lean Canvas</div>
        <div class="card-desc">Ù„Ù„Ø³ØªØ§Ø±ØªØ§Ø¨ ÙˆØ§Ù„Ø£ÙÙƒØ§Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</div>
        <div class="card-author">Ash Maurya</div>
      </div>
      <div class="welcome-card" style="--c:var(--c-mkt)" onclick="showCanvas('Marketing')">
        <span class="card-icon">ğŸ“Š</span>
        <div class="card-title">Marketing Canvas</div>
        <div class="card-desc">Ø®Ø·Ø© Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„Ø© Ù…Ø¹ 4Ps</div>
        <div class="card-author">Marketing Framework</div>
      </div>
      <div class="welcome-card" style="--c:var(--c-vpc)" onclick="showCanvas('VPC')">
        <span class="card-icon">ğŸ¯</span>
        <div class="card-title">Value Proposition Canvas</div>
        <div class="card-desc">ØªØ­Ù„ÙŠÙ„ Ù‚ÙŠÙ…ØªÙƒ Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø¹Ù…Ù‚</div>
        <div class="card-author">Alexander Osterwalder</div>
      </div>
      <div class="welcome-card" style="--c:var(--c-swot)" onclick="showCanvas('SWOT')">
        <span class="card-icon">ğŸ“ˆ</span>
        <div class="card-title">SWOT Analysis</div>
        <div class="card-desc">ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ¦ÙŠ Ø¯Ø§Ø®Ù„ÙŠ ÙˆØ®Ø§Ø±Ø¬ÙŠ</div>
        <div class="card-author">Strategic Planning</div>
      </div>
      <div class="welcome-card" style="--c:var(--c-aarrr)" onclick="showCanvas('AARRR')">
        <span class="card-icon">ğŸš€</span>
        <div class="card-title">AARRR Funnel</div>
        <div class="card-desc">Ù‚Ù…Ø¹ Ø§Ù„Ù†Ù…Ùˆ Ù„Ù„Ø³ØªØ§Ø±ØªØ§Ø¨</div>
        <div class="card-author">Dave McClure</div>
      </div>
    </div>
  </div>

  <!-- CANVAS VIEW -->
  <div id="canvas-view">
    <!-- Desktop topbar -->
    <div class="canvas-topbar" id="topbar">
      <div>
        <div class="canvas-topbar-title" id="topbar-title"></div>
        <div class="canvas-topbar-sub" id="topbar-sub"></div>
      </div>
      <div style="display:flex;gap:8px;margin-left:auto">
        <button class="top-btn pdf"   onclick="exportPDF()">ğŸ“„ ØªØµØ¯ÙŠØ± PDF</button>
        <button class="top-btn save"  onclick="saveCurrentCanvas()">ğŸ’¾ Ø­ÙØ¸</button>
        <button class="top-btn clear" onclick="clearCurrentCanvas()">ğŸ—‘ï¸ Ù…Ø³Ø­</button>
        <button class="top-btn back"  onclick="showWelcome()">ğŸ  Ø±Ø¬ÙˆØ¹</button>
      </div>
    </div>
    <div class="topbar-accent-line" id="accent-line"></div>

    <div class="canvas-scroll-area" id="canvas-scroll">
      <!-- dynamic grid injected here -->
    </div>
  </div>

  <!-- MOBILE BOTTOM NAV -->
  <nav id="mobile-bottom-nav">
    <div class="mobile-nav-inner">
      <button class="mobile-nav-item active" data-mob-view="welcome" onclick="showWelcome()" style="--c:var(--text)">
        <span class="mn-icon">ğŸ </span>Home
      </button>
      <div class="mobile-nav-divider"></div>
      <button class="mobile-nav-item" data-mob-canvas="BMC" onclick="showCanvas('BMC')" style="--c:var(--c-bmc)">
        <span class="mn-icon">ğŸ¯</span>BMC
      </button>
      <button class="mobile-nav-item" data-mob-canvas="Lean" onclick="showCanvas('Lean')" style="--c:var(--c-lean)">
        <span class="mn-icon">ğŸ§ </span>Lean
      </button>
      <button class="mobile-nav-item" data-mob-canvas="Marketing" onclick="showCanvas('Marketing')" style="--c:var(--c-mkt)">
        <span class="mn-icon">ğŸ“Š</span>Mkt
      </button>
      <button class="mobile-nav-item" data-mob-canvas="VPC" onclick="showCanvas('VPC')" style="--c:var(--c-vpc)">
        <span class="mn-icon">ğŸ¯</span>VPC
      </button>
      <button class="mobile-nav-item" data-mob-canvas="SWOT" onclick="showCanvas('SWOT')" style="--c:var(--c-swot)">
        <span class="mn-icon">ğŸ“ˆ</span>SWOT
      </button>
      <button class="mobile-nav-item" data-mob-canvas="AARRR" onclick="showCanvas('AARRR')" style="--c:var(--c-aarrr)">
        <span class="mn-icon">ğŸš€</span>AARRR
      </button>
    </div>
  </nav>

</main>

<!-- TOAST -->
<div id="toast"></div>

<!-- PDF OVERLAY -->
<div id="pdf-overlay">
  <div class="pdf-modal">
    <div class="pdf-spinner"></div>
    <h3>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØµØ¯ÙŠØ±...</h3>
    <p>ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø©</p>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CANVAS DEFINITIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CANVASES = {
  BMC: {
    title: "ğŸ¯ Business Model Canvas",
    subtitle: "Alexander Osterwalder",
    color: "var(--c-bmc)", colorHex: "#e94560",
    gridClass: "grid-bmc",
    cells: [
      { key:"partners",   cls:"bmc-partners",   label:"ğŸ¤ Key Partnerships\nØ§Ù„Ø´Ø±Ø§ÙƒØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©",         hint:"Ø´Ø±ÙƒØ§Ø¡ØŒ Ù…ÙˆØ±Ø¯ÙŠÙ†ØŒ Ø¯Ø§Ø¹Ù…ÙŠÙ†..." },
      { key:"activities", cls:"bmc-activities",  label:"âš™ï¸ Key Activities\nØ§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©",            hint:"Ø£Ù‡Ù… Ø£Ù†Ø´Ø·Ø© Ø¨ØªØ¹Ù…Ù„Ù‡Ø§ Ø¹Ø´Ø§Ù† ØªÙ‚Ø¯Ù… Ø§Ù„Ù‚ÙŠÙ…Ø©..." },
      { key:"value",      cls:"bmc-value",        label:"ğŸ’ Value Proposition\nØ§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©",            hint:"Ø¥ÙŠÙ‡ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ù„ÙŠ Ø¨ØªØ­Ù„Ù‡Ø§ØŸ ÙˆØ¥ÙŠÙ‡ Ø§Ù„Ù„ÙŠ Ø¨ÙŠÙ…ÙŠØ²ÙƒØŸ" },
      { key:"relations",  cls:"bmc-relations",    label:"â¤ï¸ Customer Relationships\nØ¹Ù„Ø§Ù‚Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡",       hint:"Ø¯Ø¹Ù… Ù…Ø¨Ø§Ø´Ø± â€“ Ø®Ø¯Ù…Ø© Ø°Ø§ØªÙŠØ© â€“ Ø§Ø´ØªØ±Ø§Ùƒ..." },
      { key:"segments",   cls:"bmc-segments",     label:"ğŸ‘¥ Customer Segments\nØ´Ø±Ø§Ø¦Ø­ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡",            hint:"Ø·Ù„Ø¨Ø© â€“ Ø´Ø±ÙƒØ§Øª â€“ Ù…ÙƒØªØ¨Ø§Øª â€“ Ø£ÙØ±Ø§Ø¯..." },
      { key:"resources",  cls:"bmc-resources",    label:"ğŸ—ï¸ Key Resources\nØ§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©",            hint:"ÙØ±ÙŠÙ‚ â€“ ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ â€“ Ø¨Ø±Ø§Ù†Ø¯..." },
      { key:"channels",   cls:"bmc-channels",     label:"ğŸ“¡ Channels\nÙ‚Ù†ÙˆØ§Øª Ø§Ù„ØªÙˆØ²ÙŠØ¹",                    hint:"Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§ â€“ Ù…ÙˆÙ‚Ø¹ â€“ Ù…ÙˆØ²Ø¹ÙŠÙ†..." },
      { key:"cost",       cls:"bmc-cost",          label:"ğŸ’¸ Cost Structure\nÙ‡ÙŠÙƒÙ„ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ",              hint:"Ø£ÙƒØ¨Ø± Ù…ØµØ§Ø±ÙŠÙ Ø¹Ù†Ø¯Ùƒ Ø¥ÙŠÙ‡ØŸ" },
      { key:"revenue",    cls:"bmc-revenue",       label:"ğŸ’° Revenue Streams\nÙ…ØµØ§Ø¯Ø± Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª",           hint:"Ø¨ÙŠØ¹ Ù…Ø¨Ø§Ø´Ø± â€“ Ø§Ø´ØªØ±Ø§ÙƒØ§Øª â€“ Ø¹Ù…ÙˆÙ„Ø§Øª..." },
    ]
  },
  Lean: {
    title: "ğŸ§  Lean Canvas",
    subtitle: "Ash Maurya",
    color: "var(--c-lean)", colorHex: "#4ecca3",
    gridClass: "grid-lean",
    cells: [
      { key:"problem",   cls:"lean-problem",   label:"âš¡ Problem\nØ§Ù„Ù…Ø´ÙƒÙ„Ø©",                       hint:"Ø£Ù‡Ù… 3 Ù…Ø´Ø§ÙƒÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø¹Ù…ÙŠÙ„..." },
      { key:"solution",  cls:"lean-solution",  label:"ğŸ’¡ Solution\nØ§Ù„Ø­Ù„",                         hint:"Ø¥Ø²Ø§ÙŠ Ù‡ØªØ­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©ØŸ" },
      { key:"uvp",       cls:"lean-uvp",        label:"ğŸŒŸ Unique Value Proposition\nØ§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„ÙØ±ÙŠØ¯Ø©", hint:"ÙˆØ¹Ø¯ ÙˆØ§Ø¶Ø­ ÙˆÙ…Ø®ØªØµØ± ÙŠÙ…ÙŠØ²Ùƒ..." },
      { key:"unfair",    cls:"lean-unfair",     label:"ğŸ”’ Unfair Advantage\nÙ…ÙŠØ²Ø© ØªÙ†Ø§ÙØ³ÙŠØ©",         hint:"Ø­Ø§Ø¬Ø© Ù…Ø­Ø¯Ø´ ÙŠØ¹Ø±Ù ÙŠÙ‚Ù„Ø¯Ù‡Ø§ Ø¨Ø³Ù‡ÙˆÙ„Ø©..." },
      { key:"segments",  cls:"lean-segments",  label:"ğŸ‘¥ Customer Segments\nØ§Ù„Ø¹Ù…Ù„Ø§Ø¡",             hint:"Ù…ÙŠÙ† Ø¹Ù†Ø¯Ù‡ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¯ÙŠØŸ" },
      { key:"metrics",   cls:"lean-metrics",   label:"ğŸ“Š Key Metrics\nÙ…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡",             hint:"Ø¥Ø²Ø§ÙŠ ØªÙ‚ÙŠØ³ Ù†Ø¬Ø§Ø­ÙƒØŸ" },
      { key:"channels",  cls:"lean-channels",  label:"ğŸ“¡ Channels\nØ§Ù„Ù‚Ù†ÙˆØ§Øª",                      hint:"Ù‡ØªÙˆØµÙ„ Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø¥Ø²Ø§ÙŠØŸ" },
      { key:"cost",      cls:"lean-cost",       label:"ğŸ’¸ Cost Structure\nØ§Ù„ØªÙƒØ§Ù„ÙŠÙ",               hint:"Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©..." },
      { key:"revenue",   cls:"lean-revenue",    label:"ğŸ’° Revenue Streams\nØ§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª",             hint:"Ø·Ø±Ù‚ Ø§Ù„Ø±Ø¨Ø­..." },
    ]
  },
  Marketing: {
    title: "ğŸ“Š Marketing Canvas",
    subtitle: "Ø®Ø·Ø© Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„Ø©",
    color: "var(--c-mkt)", colorHex: "#ffd700",
    gridClass: "grid-marketing",
    cells: [
      { key:"target",      label:"ğŸ¯ Target Market\nØ§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù",       hint:"Ù…ÙŠÙ† Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠØŸ" },
      { key:"positioning", label:"ğŸ“ Positioning\nØ§Ù„ØªÙ…ÙˆØ¶Ø¹",               hint:"Ø¹Ø§ÙŠØ² Ø§Ù„Ù†Ø§Ø³ ØªØ´ÙˆÙÙƒ Ø¥Ø²Ø§ÙŠØŸ" },
      { key:"objectives",  label:"ğŸ† Marketing Objectives\nØ£Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ³ÙˆÙŠÙ‚", hint:"Ù…Ø¨ÙŠØ¹Ø§ØªØŸ Ø§Ù†ØªØ´Ø§Ø±ØŸ LeadsØŸ" },
      { key:"product",     label:"ğŸ“¦ Product\nØ§Ù„Ù…Ù†ØªØ¬",                     hint:"ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬/Ø§Ù„Ø®Ø¯Ù…Ø©..." },
      { key:"price",       label:"ğŸ’² Price\nØ§Ù„Ø³Ø¹Ø±",                        hint:"Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„ØªØ³Ø¹ÙŠØ±..." },
      { key:"place",       label:"ğŸ—ºï¸ Place\nØ§Ù„Ù…ÙƒØ§Ù†",                      hint:"Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø¨ÙŠØ¹ ÙˆØ§Ù„ØªÙˆØ²ÙŠØ¹..." },
      { key:"promotion",   label:"ğŸ“£ Promotion\nØ§Ù„ØªØ±ÙˆÙŠØ¬",                  hint:"ÙƒÙŠÙ Ø³ØªØ±ÙˆØ¬ Ù„Ù„Ù…Ù†ØªØ¬ØŸ" },
      { key:"budget",      label:"ğŸ’° Budget\nØ§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©",                   hint:"ÙƒØ§Ù… Ù‡ØªØµØ±ÙØŸ" },
      { key:"kpis",        label:"ğŸ“ˆ KPIs\nÙ…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù‚ÙŠØ§Ø³",                 hint:"Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„ â€“ ØªÙƒÙ„ÙØ© Ø§Ù„Ø¹Ù…ÙŠÙ„..." },
    ]
  },
  VPC: {
    title: "ğŸ¯ Value Proposition Canvas",
    subtitle: "Alexander Osterwalder",
    color: "var(--c-vpc)", colorHex: "#a855f7",
    gridClass: "grid-vpc",
    cells: [
      { key:"products",     label:"ğŸ›ï¸ Products & Services\nØ§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª", hint:"Ù…Ø§Ø°Ø§ ØªÙ‚Ø¯Ù… Ù„Ù„Ø¹Ù…ÙŠÙ„ØŸ" },
      { key:"jobs",         label:"ğŸ”¨ Customer Jobs\nÙ…Ù‡Ø§Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„",              hint:"Ù‡Ùˆ Ø¹Ø§ÙŠØ² ÙŠØ¹Ù…Ù„ Ø¥ÙŠÙ‡ØŸ" },
      { key:"pain_rel",     label:"ğŸ’Š Pain Relievers\nÙ…Ø®ÙÙØ§Øª Ø§Ù„Ø£Ù„Ù…",            hint:"Ø¥Ø²Ø§ÙŠ Ø¨ØªÙ‚Ù„Ù„ Ø§Ù„Ø£Ù„Ù…ØŸ" },
      { key:"pains",        label:"ğŸ˜£ Pains\nØ§Ù„Ù…Ø´Ø§ÙƒÙ„ ÙˆØ§Ù„Ù…Ø¹Ø§Ù†Ø§Ø©",               hint:"Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù„ÙŠ Ø¨ÙŠØ¹Ø§Ù†ÙŠ Ù…Ù†Ù‡Ø§..." },
      { key:"gain_cr",      label:"ğŸš€ Gain Creators\nÙ…Ø­Ù‚Ù‚Ùˆ Ø§Ù„Ù…ÙƒØ§Ø³Ø¨",           hint:"Ø¥Ø²Ø§ÙŠ Ø¨ØªØ²ÙˆØ¯ Ø§Ù„Ù…ÙƒØ§Ø³Ø¨ØŸ" },
      { key:"gains",        label:"ğŸŒŸ Gains\nØ§Ù„Ù…ÙƒØ§Ø³Ø¨ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©",               hint:"Ø§Ù„Ù…ÙƒØ§Ø³Ø¨ Ø§Ù„Ù„ÙŠ Ù…Ø³ØªÙ†ÙŠÙ‡Ø§..." },
    ]
  },
  SWOT: {
    title: "ğŸ“ˆ SWOT Analysis",
    subtitle: "ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ¦ÙŠ Ø´Ø§Ù…Ù„",
    color: "var(--c-swot)", colorHex: "#38bdf8",
    gridClass: "grid-swot",
    cells: [
      { key:"strengths",     label:"ğŸ’ª Strengths\nÙ†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©",   hint:"Ù…Ø§ Ø§Ù„Ø°ÙŠ ØªØªÙ…ÙŠØ² Ø¨Ù‡ØŸ" },
      { key:"weaknesses",    label:"âš ï¸ Weaknesses\nÙ†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù", hint:"Ù…Ø§ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†ØŸ" },
      { key:"opportunities", label:"ğŸŒ± Opportunities\nØ§Ù„ÙØ±Øµ",    hint:"Ø§Ù„ÙØ±Øµ Ø§Ù„Ù…ØªØ§Ø­Ø© ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚..." },
      { key:"threats",       label:"ğŸ”¥ Threats\nØ§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª",      hint:"Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©..." },
    ]
  },
  AARRR: {
    title: "ğŸš€ Growth Hacking Funnel (AARRR)",
    subtitle: "Dave McClure",
    color: "var(--c-aarrr)", colorHex: "#fb923c",
    gridClass: "grid-aarrr",
    cells: [
      { key:"acquisition", cls:"aarrr-cell", label:"ğŸ£ Acquisition\nØ§ÙƒØªØ³Ø§Ø¨ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡",  hint:"Ù…Ù† Ø£ÙŠÙ† ÙŠØ£ØªÙŠ Ø¹Ù…Ù„Ø§Ø¤ÙƒØŸ Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø§ÙƒØªØ³Ø§Ø¨..." },
      { key:"activation",  cls:"aarrr-cell", label:"âš¡ Activation\nØ£ÙˆÙ„ ØªØ¬Ø±Ø¨Ø© Ù†Ø§Ø¬Ø­Ø©",  hint:"ÙƒÙŠÙ ØªÙØ´Ø¹ÙØ± Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©ØŸ" },
      { key:"retention",   cls:"aarrr-cell", label:"ğŸ”„ Retention\nØ§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡", hint:"ÙƒÙŠÙ ØªÙØ¨Ù‚ÙŠ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙŠØ¹ÙˆØ¯ÙˆÙ†ØŸ" },
      { key:"revenue",     cls:"aarrr-cell", label:"ğŸ’µ Revenue\nØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø¯Ø®Ù„",         hint:"ÙƒÙŠÙ ØªØ­Ù‚Ù‚ Ø¥ÙŠØ±Ø§Ø¯Ø§Ù‹ Ù…Ù† Ø¹Ù…Ù„Ø§Ø¦ÙƒØŸ" },
      { key:"referral",    cls:"aarrr-cell", label:"ğŸ“¢ Referral\nØ§Ù„Ø¥Ø­Ø§Ù„Ø©",            hint:"ÙƒÙŠÙ ÙŠÙØ­ÙŠÙ„ Ø¹Ù…Ù„Ø§Ø¤Ùƒ Ø£ØµØ¯Ù‚Ø§Ø¡Ù‡Ù… Ø¥Ù„ÙŠÙƒØŸ" },
    ]
  }
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentCanvas = null;

function loadData() {
  try { return JSON.parse(localStorage.getItem('canvas_studio_data') || '{}'); }
  catch(e) { return {}; }
}
function saveData(d) { localStorage.setItem('canvas_studio_data', JSON.stringify(d)); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  MOBILE SIDEBAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleSidebar() {
  const sidebar = document.getElementById('sidebar');
  const overlay = document.getElementById('sidebar-overlay');
  const isOpen = sidebar.classList.toggle('open');
  overlay.classList.toggle('show', isOpen);
}
function closeSidebar() {
  document.getElementById('sidebar').classList.remove('open');
  document.getElementById('sidebar-overlay').classList.remove('show');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showWelcome() {
  currentCanvas = null;
  closeSidebar();
  document.getElementById('welcome').classList.add('visible');
  document.getElementById('canvas-view').classList.remove('visible');
  document.getElementById('mobile-title').textContent = 'ğŸ§© Canvas Studio';

  // Update nav states
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.querySelector('[data-view="welcome"]').classList.add('active');
  document.querySelectorAll('.mobile-nav-item').forEach(b => b.classList.remove('active'));
  document.querySelector('[data-mob-view="welcome"]').classList.add('active');
}

function showCanvas(key) {
  currentCanvas = key;
  const cfg = CANVASES[key];
  const data = loadData();
  closeSidebar();

  // Update desktop topbar
  document.getElementById('topbar-title').textContent = cfg.title;
  document.getElementById('topbar-sub').textContent = `by ${cfg.subtitle}`;
  document.getElementById('accent-line').style.background = cfg.colorHex;
  document.getElementById('canvas-view').style.setProperty('--accent-current', cfg.colorHex);
  document.getElementById('topbar').style.setProperty('--accent-current', cfg.colorHex);

  // Update mobile title
  document.getElementById('mobile-title').textContent = cfg.title;

  // Build grid
  const scroll = document.getElementById('canvas-scroll');
  scroll.innerHTML = '';
  const grid = document.createElement('div');
  grid.className = `canvas-grid ${cfg.gridClass}`;

  cfg.cells.forEach((cell, i) => {
    const div = document.createElement('div');
    div.className = `canvas-cell ${cell.cls || ''}`;
    div.style.setProperty('--accent-current', cfg.colorHex);
    div.style.animationDelay = `${i * 0.04}s`;

    const labelLines = cell.label.split('\n');
    div.innerHTML = `
      <div class="cell-header">
        <div class="cell-header-text">${labelLines[0]}<br><span style="opacity:0.7;font-size:10px">${labelLines[1] || ''}</span></div>
      </div>
      <div class="cell-hint">ğŸ’¡ ${cell.hint}</div>
      <textarea class="cell-textarea"
        placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ù‡Ù†Ø§..."
        data-key="${cell.key}"
        rows="5"
      >${(data[key] || {})[cell.key] || ''}</textarea>
    `;
    grid.appendChild(div);
  });

  scroll.appendChild(grid);

  // Auto-save on input
  scroll.querySelectorAll('textarea').forEach(ta => {
    ta.addEventListener('input', () => autoSave(key, ta.dataset.key, ta.value));
  });

  // Show view
  document.getElementById('welcome').classList.remove('visible');
  document.getElementById('canvas-view').classList.add('visible');

  // Update sidebar nav
  document.querySelectorAll('.nav-btn').forEach(b => {
    b.classList.remove('active');
    b.style.borderLeftColor = '';
    b.style.color = '';
  });
  const btn = document.querySelector(`[data-canvas="${key}"]`);
  if (btn) {
    btn.classList.add('active');
    btn.style.borderLeftColor = cfg.colorHex;
    btn.style.color = cfg.colorHex;
  }

  // Update mobile bottom nav
  document.querySelectorAll('.mobile-nav-item').forEach(b => b.classList.remove('active'));
  const mobBtn = document.querySelector(`[data-mob-canvas="${key}"]`);
  if (mobBtn) mobBtn.classList.add('active');

  // Scroll to top
  scroll.scrollTop = 0;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SAVE / CLEAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function autoSave(canvasKey, fieldKey, value) {
  const data = loadData();
  if (!data[canvasKey]) data[canvasKey] = {};
  data[canvasKey][fieldKey] = value;
  saveData(data);
}

function saveCurrentCanvas() {
  if (!currentCanvas) { showToast('Ø§Ø®ØªØ± canvas Ø£ÙˆÙ„Ø§Ù‹'); return; }
  const data = loadData();
  if (!data[currentCanvas]) data[currentCanvas] = {};
  document.querySelectorAll('#canvas-scroll textarea').forEach(ta => {
    data[currentCanvas][ta.dataset.key] = ta.value;
  });
  saveData(data);
  showToast('âœ… ØªÙ… Ø§Ù„Ø­ÙØ¸!');
}

function saveAll() {
  if (currentCanvas) saveCurrentCanvas();
  showToast('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„ÙƒÙ„!');
}

function clearCurrentCanvas() {
  if (!currentCanvas) return;
  if (!confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª ${currentCanvas}ØŸ`)) return;
  const data = loadData();
  delete data[currentCanvas];
  saveData(data);
  document.querySelectorAll('#canvas-scroll textarea').forEach(ta => ta.value = '');
  showToast('ğŸ—‘ï¸ ØªÙ… Ø§Ù„Ù…Ø³Ø­');
}

function clearAll() {
  if (!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹!')) return;
  localStorage.removeItem('canvas_studio_data');
  showToast('ğŸ—‘ï¸ ØªÙ… Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
  showWelcome();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  PDF EXPORT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function exportPDF() {
  if (!currentCanvas) { showToast('Ø§Ø®ØªØ± canvas Ø£ÙˆÙ„Ø§Ù‹'); return; }
  saveCurrentCanvas();

  const cfg = CANVASES[currentCanvas];
  const overlay = document.getElementById('pdf-overlay');
  overlay.classList.add('show');

  try {
    const scrollArea = document.getElementById('canvas-scroll');
    const grid = scrollArea.querySelector('.canvas-grid');

    const origOverflow = scrollArea.style.overflow;
    const origHeight   = scrollArea.style.height;
    scrollArea.style.overflow = 'visible';
    scrollArea.style.height = 'auto';

    await new Promise(r => setTimeout(r, 200));

    const canvas = await html2canvas(grid, {
      backgroundColor: '#0a0a14',
      scale: 2,
      useCORS: true,
      logging: false,
      allowTaint: true,
      width: grid.scrollWidth,
      height: grid.scrollHeight,
      windowWidth: grid.scrollWidth + 40,
    });

    scrollArea.style.overflow = origOverflow;
    scrollArea.style.height = origHeight;

    const { jsPDF } = window.jspdf;
    const imgW = canvas.width;
    const imgH = canvas.height;
    const pageW = 297, pageH = 210;

    const ratio = Math.min(pageW / (imgW / 3.7795), pageH / (imgH / 3.7795));
    const finalW = (imgW / 3.7795) * ratio;
    const finalH = (imgH / 3.7795) * ratio;

    const pdf = new jsPDF({ orientation: 'landscape', unit: 'mm', format: 'a4' });

    pdf.setFillColor(10, 10, 20);
    pdf.rect(0, 0, pageW, pageH, 'F');

    const hColor = cfg.colorHex.replace('#','');
    const r = parseInt(hColor.slice(0,2),16);
    const g = parseInt(hColor.slice(2,4),16);
    const b = parseInt(hColor.slice(4,6),16);

    pdf.setFillColor(19, 19, 31);
    pdf.rect(0, 0, pageW, 14, 'F');
    pdf.setDrawColor(r, g, b);
    pdf.setLineWidth(0.8);
    pdf.line(0, 14, pageW, 14);
    pdf.setTextColor(r, g, b);
    pdf.setFontSize(13);
    pdf.setFont('helvetica', 'bold');
    pdf.text(cfg.title.replace(/[^\x00-\x7F]/g, '').trim() || currentCanvas, 6, 9);
    pdf.setTextColor(120, 120, 150);
    pdf.setFontSize(8);
    pdf.setFont('helvetica', 'normal');
    pdf.text(`by ${cfg.subtitle}`, 6, 12.5);
    pdf.text(new Date().toISOString().slice(0,19).replace('T',' '), pageW - 6, 12.5, { align:'right' });

    const imgData = canvas.toDataURL('image/jpeg', 0.92);
    const xOff = (pageW - finalW) / 2;
    pdf.addImage(imgData, 'JPEG', xOff, 16, finalW, Math.min(finalH, pageH - 20));

    pdf.setFillColor(10, 10, 20);
    pdf.rect(0, pageH - 7, pageW, 7, 'F');
    pdf.setTextColor(70, 70, 90);
    pdf.setFontSize(7);
    pdf.text(`Business Canvas Studio  â€¢  ${currentCanvas}`, pageW/2, pageH - 2, { align:'center' });

    pdf.save(`${currentCanvas}_${Date.now()}.pdf`);
    showToast('ğŸ“„ ØªÙ… ØªØµØ¯ÙŠØ± PDF Ø¨Ù†Ø¬Ø§Ø­!');

  } catch(err) {
    console.error(err);
    showToast('âŒ ÙØ´Ù„ Ø§Ù„ØªØµØ¯ÙŠØ±: ' + err.message, true);
  } finally {
    overlay.classList.remove('show');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showToast(msg, isError=false) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.className = isError ? 'error' : '';
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CLOCK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function tick() {
  const now = new Date();
  document.getElementById('clock').textContent = `${now.toLocaleDateString('ar-EG')}\n${now.toLocaleTimeString('ar-EG')}`;
}
tick();
setInterval(tick, 1000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  KEYBOARD SHORTCUTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('keydown', e => {
  if ((e.ctrlKey || e.metaKey) && e.key === 's') { e.preventDefault(); saveCurrentCanvas(); }
  if ((e.ctrlKey || e.metaKey) && e.key === 'p') { e.preventDefault(); exportPDF(); }
  if (e.key === 'Escape') closeSidebar();
});

// Close sidebar on resize to desktop
window.addEventListener('resize', () => {
  if (window.innerWidth > 640) closeSidebar();
});

// Sidebar nav hover effects (desktop)
document.querySelectorAll('.nav-btn[data-canvas]').forEach(btn => {
  btn.addEventListener('mouseenter', () => {
    if (!btn.classList.contains('active')) btn.style.color = btn.style.getPropertyValue('--c') || '';
  });
  btn.addEventListener('mouseleave', () => {
    if (!btn.classList.contains('active')) btn.style.color = '';
  });
});
</script>
</body>
</html>
